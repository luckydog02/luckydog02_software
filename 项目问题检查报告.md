# 医院管理系统 - 项目问题检查报告

## 🔴 严重问题（需要立即修复）

### 1. 安全漏洞

#### 1.1 数据库密码硬编码
**位置**: `hospital-backend/src/main/resources/application.yml`
```yaml
password: 123456
```
**问题**: 数据库密码直接写在配置文件中，存在安全风险
**建议**: 
- 使用环境变量或配置中心管理敏感信息
- 使用Spring Boot的`@ConfigurationProperties`和外部配置文件
- 生产环境必须使用强密码

#### 1.2 JWT签名密钥硬编码
**位置**: `hospital-backend/src/main/java/com/shanzhu/hospital/utils/JwtUtil.java:22`
```java
private static String SIGNAL = "1HU&**UUY**(GNH";
```
**问题**: JWT签名密钥硬编码在代码中，容易被泄露
**建议**: 
- 将密钥移到配置文件或环境变量
- 使用更复杂的密钥（至少32字符）
- 不同环境使用不同的密钥

#### 1.3 数据库连接不安全
**位置**: `hospital-backend/src/main/resources/application.yml:15`
```yaml
url: jdbc:mysql://localhost:3306/DB_Hospital?characterEncoding=utf8&useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
```
**问题**: 
- `useSSL=false` 禁用了SSL加密，数据传输不安全
- `allowPublicKeyRetrieval=true` 存在安全风险
**建议**: 
- 生产环境必须启用SSL：`useSSL=true`
- 移除或谨慎使用`allowPublicKeyRetrieval`

#### 1.4 Maven仓库使用HTTP协议
**位置**: `hospital-backend/pom.xml:140,157`
```xml
<url>http://maven.aliyun.com/nexus/content/groups/public/</url>
```
**问题**: 使用HTTP而不是HTTPS，存在中间人攻击风险
**建议**: 改为HTTPS协议

### 2. 依赖版本过时（存在安全漏洞）

#### 2.1 前端依赖
- **axios**: `^0.21.1` - 版本过旧，存在已知安全漏洞，建议升级到 `^1.6.0+`
- **echarts**: `^4.8.0` - 版本较旧，建议升级到 `^5.4.0+`

#### 2.2 后端依赖
- **Spring Boot**: `2.2.4.RELEASE` - 版本较旧（2020年发布），建议升级到 `2.7.x` 或 `3.x`
- **MyBatis Plus**: `3.1.1` - 版本较旧，建议升级到 `3.5.x+`
- **java-jwt**: `3.4.0` - 版本较旧，建议升级到 `4.x`
- **itextpdf**: `5.5.11` - 版本较旧，建议升级到最新版本
- **easypoi**: `3.2.0` - 版本较旧，建议检查是否有更新版本

## ⚠️ 中等问题（建议修复）

### 3. 代码质量问题

#### 3.1 异常处理不当
**位置**: `hospital-backend/src/main/java/com/shanzhu/hospital/config/JwtInterceptor.java`
```java
e.printStackTrace();  // 第30, 33, 36, 39行
```
**问题**: 使用`printStackTrace()`输出异常，应该使用日志框架
**建议**: 
- 使用`@Slf4j`注解和`log.error()`记录异常
- 避免在生产环境直接打印堆栈

#### 3.2 前端调试代码未清理
**位置**: 多个Vue文件
- `hospital-frontend/src/views/patient/DoctorTeam.vue:116`
- `hospital-frontend/src/views/patient/BookNow.vue:263`
- `hospital-frontend/src/views/patient/HospitalIntroduction.vue:114`
- `hospital-frontend/src/views/DataExpore.vue:82,120,165`
- `hospital-frontend/src/views/patient/PatientHome.vue:43,55`
- `hospital-frontend/src/views/doctor/DealOrderAgain.vue:243`

**问题**: 生产代码中包含`console.error()`调用
**建议**: 
- 使用环境变量控制是否输出调试信息
- 或使用日志库替代`console.error`
- 生产环境应该移除或禁用

#### 3.3 缺少错误处理
**位置**: `hospital-frontend/src/utils/request.js`
**问题**: 缺少响应拦截器处理错误情况
**建议**: 添加响应拦截器统一处理HTTP错误和业务错误

### 4. 配置问题

#### 4.1 前端代理配置不完整
**位置**: `hospital-frontend/vue.config.js:12`
```javascript
proxy: "http://localhost:9281",
```
**问题**: 代理配置过于简单，缺少路径重写等配置
**建议**: 使用对象形式配置代理，支持更灵活的配置

#### 4.2 ESLint被禁用
**位置**: `hospital-frontend/vue.config.js:7`
```javascript
lintOnSave: false,
```
**问题**: 禁用了保存时的代码检查
**建议**: 启用ESLint检查，提高代码质量

## 💡 改进建议

### 5. 代码规范

#### 5.1 缺少统一的错误处理机制
- 前端缺少全局错误处理
- 后端缺少统一的异常处理类（`@ControllerAdvice`）

#### 5.2 缺少API文档
- 建议添加Swagger/OpenAPI文档
- 方便前后端协作和API测试

#### 5.3 缺少单元测试
- 建议添加JUnit测试（后端）
- 建议添加Vue组件测试（前端）

#### 5.4 代码注释不足
- 部分关键业务逻辑缺少注释
- 建议添加JavaDoc和JSDoc注释

### 6. 性能优化

#### 6.1 前端资源优化
- 考虑使用路由懒加载
- 优化图片资源大小

#### 6.2 后端性能
- 检查数据库查询是否有N+1问题
- 考虑添加缓存机制

### 7. 部署相关

#### 7.1 缺少环境配置
- 建议区分开发、测试、生产环境配置
- 使用`application-dev.yml`、`application-prod.yml`等

#### 7.2 缺少Docker配置
- 建议添加Dockerfile和docker-compose.yml
- 方便部署和运维

## 📋 优先级修复建议

### 立即修复（P0）
1. ✅ 修复数据库密码硬编码问题
2. ✅ 修复JWT密钥硬编码问题
3. ✅ 升级axios到安全版本
4. ✅ 启用数据库SSL连接

### 尽快修复（P1）
1. ✅ 修复Maven仓库HTTP协议问题
2. ✅ 改进异常处理（使用日志框架）
3. ✅ 清理前端console.error调用
4. ✅ 添加响应拦截器

### 计划修复（P2）
1. ✅ 升级其他过时依赖
2. ✅ 添加统一异常处理
3. ✅ 启用ESLint
4. ✅ 添加API文档

---

**检查日期**: 2024年
**检查范围**: 前后端代码、配置文件、依赖版本

