# ğŸ¥ åŒ»é™¢å‰ç«¯é¡¹ç›®æµ‹è¯•æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°
æœ¬æ–‡æ¡£æè¿°äº†åŒ»é™¢å‰ç«¯é¡¹ç›® (`hospital-frontend`) çš„æµ‹è¯•ç­–ç•¥ã€æµ‹è¯•ç±»å‹å’Œæ‰§è¡Œæ–¹æ³•ã€‚

## ğŸ§ª æµ‹è¯•ç±»å‹

### 1. å•å…ƒæµ‹è¯• (Unit Testing)
- **æµ‹è¯•ç›®æ ‡**: ç»„ä»¶ã€å·¥å…·å‡½æ•°ã€ä¸šåŠ¡é€»è¾‘
- **æµ‹è¯•æ¡†æ¶**: Vue Test Utils + Jest
- **æµ‹è¯•ä½ç½®**: `tests/unit/` ç›®å½•ï¼ˆéœ€åˆ›å»ºï¼‰

#### å•å…ƒæµ‹è¯•ç¤ºä¾‹
```javascript
// tests/unit/components/LoginForm.spec.js
import { shallowMount } from '@vue/test-utils'
import LoginForm from '@/components/LoginForm.vue'

describe('LoginForm.vue', () => {
  it('éªŒè¯ç™»å½•è¡¨å•æ¸²æŸ“', () => {
    const wrapper = shallowMount(LoginForm)
    expect(wrapper.find('form').exists()).toBe(true)
    expect(wrapper.find('input[type="text"]').exists()).toBe(true)
    expect(wrapper.find('input[type="password"]').exists()).toBe(true)
  })
  
  it('è¡¨å•æäº¤æ—¶è§¦å‘ç™»å½•äº‹ä»¶', async () => {
    const wrapper = shallowMount(LoginForm)
    await wrapper.find('form').trigger('submit')
    expect(wrapper.emitted('login')).toBeTruthy()
  })
})
```

### 2. ç»„ä»¶æµ‹è¯• (Component Testing)
- **æµ‹è¯•ç›®æ ‡**: Vue ç»„ä»¶çš„äº¤äº’å’ŒçŠ¶æ€
- **æµ‹è¯•æ¡†æ¶**: Vue Test Utils

#### ç»„ä»¶æµ‹è¯•ç¤ºä¾‹
```javascript
// tests/unit/views/PatientList.spec.js
import { mount } from '@vue/test-utils'
import PatientList from '@/views/PatientList.vue'
import axios from 'axios'

jest.mock('axios')

describe('PatientList.vue', () => {
  it('åŠ è½½å¹¶æ˜¾ç¤ºæ‚£è€…åˆ—è¡¨', async () => {
    const patients = [
      { id: 1, name: 'å¼ ä¸‰', age: 30, status: 'ä½é™¢ä¸­' },
      { id: 2, name: 'æå››', age: 45, status: 'å·²å‡ºé™¢' }
    ]
    
    axios.get.mockResolvedValue({ data: patients })
    
    const wrapper = mount(PatientList)
    await wrapper.vm.$nextTick()
    
    expect(wrapper.findAll('.patient-item').length).toBe(2)
    expect(wrapper.text()).toContain('å¼ ä¸‰')
    expect(wrapper.text()).toContain('ä½é™¢ä¸­')
  })
})
```

### 3. ç«¯åˆ°ç«¯æµ‹è¯• (E2E Testing)
- **æµ‹è¯•ç›®æ ‡**: å®Œæ•´çš„ç”¨æˆ·æµç¨‹
- **æµ‹è¯•æ¡†æ¶**: Cypress
- **æµ‹è¯•ä½ç½®**: `tests/e2e/` ç›®å½•ï¼ˆéœ€åˆ›å»ºï¼‰

#### E2Eæµ‹è¯•ç¤ºä¾‹
```javascript
// tests/e2e/specs/hospital-flow.cy.js
describe('åŒ»é™¢ç®¡ç†ç³»ç»Ÿç«¯åˆ°ç«¯æµ‹è¯•', () => {
  beforeEach(() => {
    cy.visit('http://localhost:8080')
  })
  
  it('åŒ»ç”Ÿç™»å½•æµç¨‹', () => {
    cy.get('[data-test="username"]').type('doctor01')
    cy.get('[data-test="password"]').type('password123')
    cy.get('[data-test="login-btn"]').click()
    
    cy.url().should('include', '/dashboard')
    cy.get('[data-test="welcome-message"]').should('contain', 'æ¬¢è¿åŒ»ç”Ÿ')
  })
  
  it('æ‚£è€…ä¿¡æ¯æŸ¥è¯¢', () => {
    // å…ˆç™»å½•
    cy.loginAsDoctor()
    
    // å¯¼èˆªåˆ°æ‚£è€…ç®¡ç†
    cy.get('[data-test="nav-patients"]').click()
    cy.get('[data-test="search-input"]').type('ç‹äº”')
    cy.get('[data-test="search-btn"]').click()
    
    cy.get('[data-test="patient-table"]')
      .find('tr')
      .should('have.length.at.least', 1)
  })
})
```

### 4. API æ¥å£æµ‹è¯•
- **æµ‹è¯•ç›®æ ‡**: åç«¯ API æ¥å£
- **æµ‹è¯•æ¡†æ¶**: Jest + Axios
- **æµ‹è¯•ä½ç½®**: `tests/api/` ç›®å½•ï¼ˆéœ€åˆ›å»ºï¼‰

#### APIæµ‹è¯•ç¤ºä¾‹
```javascript
// tests/api/hospital-api.spec.js
import axios from 'axios'
import api from '@/utils/api'

describe('åŒ»é™¢APIæ¥å£æµ‹è¯•', () => {
  const API_BASE = 'http://localhost:3000/api'
  
  it('è·å–æ‚£è€…åˆ—è¡¨æ¥å£', async () => {
    const response = await axios.get(`${API_BASE}/patients`)
    expect(response.status).toBe(200)
    expect(Array.isArray(response.data)).toBe(true)
  })
  
  it('åˆ›å»ºé¢„çº¦æ¥å£', async () => {
    const appointment = {
      patientId: 1,
      doctorId: 2,
      date: '2024-01-15',
      time: '10:00'
    }
    
    const response = await axios.post(
      `${API_BASE}/appointments`,
      appointment
    )
    
    expect(response.status).toBe(201)
    expect(response.data).toHaveProperty('id')
  })
})
```

## ğŸ“ æµ‹è¯•ç›®å½•ç»“æ„
```bash
hospital-frontend/
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ components/          # ç»„ä»¶æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ views/              # é¡µé¢æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°æµ‹è¯•
â”‚   â”‚   â””â”€â”€ router/             # è·¯ç”±æµ‹è¯•
â”‚   â”œâ”€â”€ e2e/                    # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ specs/              # æµ‹è¯•ç”¨ä¾‹
â”‚   â”‚   â”œâ”€â”€ fixtures/           # æµ‹è¯•æ•°æ®
â”‚   â”‚   â””â”€â”€ support/            # Cypress æ”¯æŒæ–‡ä»¶
â”‚   â”œâ”€â”€ api/                    # API æ¥å£æµ‹è¯•
â”‚   â””â”€â”€ coverage/               # æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
â”œâ”€â”€ jest.config.js              # Jest é…ç½®
â”œâ”€â”€ cypress.config.js           # Cypress é…ç½®
â””â”€â”€ .nycrc                      # è¦†ç›–ç‡é…ç½®
```

## ğŸš€ æµ‹è¯•é…ç½®

### package.json æµ‹è¯•è„šæœ¬
```json
{
  "scripts": {
    "test:unit": "vue-cli-service test:unit",
    "test:e2e": "vue-cli-service test:e2e",
    "test:api": "jest tests/api --config=jest.api.config.js",
    "test:coverage": "vue-cli-service test:unit --coverage",
    "test:all": "npm run test:unit && npm run test:api",
    "test:watch": "vue-cli-service test:unit --watch"
  }
}
```

### Jest é…ç½®ç¤ºä¾‹ (jest.config.js)
```javascript
module.exports = {
  preset: '@vue/cli-plugin-unit-jest',
  testMatch: ['**/tests/unit/**/*.spec.[jt]s?(x)'],
  collectCoverage: true,
  collectCoverageFrom: [
    'src/**/*.{js,vue}',
    '!src/main.js',
    '!src/router/index.js',
    '!**/node_modules/**'
  ],
  coverageReporters: ['html', 'text-summary'],
  coverageThreshold: {
    global: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80
    }
  }
}
```

### Cypress é…ç½®ç¤ºä¾‹ (cypress.config.js)
```javascript
const { defineConfig } = require('cypress')

module.exports = defineConfig({
  e2e: {
    baseUrl: 'http://localhost:8080',
    specPattern: 'tests/e2e/specs/**/*.cy.{js,jsx,ts,tsx}',
    supportFile: 'tests/e2e/support/e2e.js',
    fixturesFolder: 'tests/e2e/fixtures',
    viewportWidth: 1280,
    viewportHeight: 720,
    video: false,
    screenshotOnRunFailure: true,
    env: {
      apiUrl: 'http://localhost:3000/api'
    }
  }
})
```

## ğŸ§© æµ‹è¯•æ•°æ®ç®¡ç†

### Mock æ•°æ®ç¤ºä¾‹
```javascript
// tests/mocks/hospital-mocks.js
export const mockPatients = [
  {
    id: 1,
    name: 'ç‹æ˜',
    age: 35,
    gender: 'ç”·',
    admissionDate: '2024-01-01',
    department: 'å†…ç§‘',
    doctor: 'å¼ åŒ»ç”Ÿ',
    status: 'ä½é™¢ä¸­'
  },
  // ... æ›´å¤šæ¨¡æ‹Ÿæ•°æ®
]

export const mockDoctors = [
  {
    id: 1,
    name: 'å¼ åŒ»ç”Ÿ',
    title: 'ä¸»ä»»åŒ»å¸ˆ',
    department: 'å†…ç§‘',
    specialty: 'å¿ƒè¡€ç®¡ç–¾ç—…',
    availableSlots: ['09:00', '10:00', '14:00']
  }
]
```

## ğŸ“Š æµ‹è¯•è¦†ç›–ç‡è¦æ±‚

| æµ‹è¯•ç±»å‹ | è¦†ç›–ç‡ç›®æ ‡ | å…³é”®æŒ‡æ ‡ |
|---------|-----------|----------|
| è¯­å¥è¦†ç›– | â‰¥ 80% | ä»£ç æ‰§è¡Œè·¯å¾„ |
| åˆ†æ”¯è¦†ç›– | â‰¥ 75% | æ¡ä»¶åˆ†æ”¯ |
| å‡½æ•°è¦†ç›– | â‰¥ 85% | å‡½æ•°è°ƒç”¨ |
| è¡Œè¦†ç›– | â‰¥ 80% | ä»£ç è¡Œæ•° |

## ğŸ”„ CI/CD é›†æˆ

### GitHub Actions ç¤ºä¾‹
```yaml
# .github/workflows/test.yml
name: åŒ»é™¢å‰ç«¯æµ‹è¯•æµæ°´çº¿

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: è®¾ç½® Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '16'
        
    - name: å®‰è£…ä¾èµ–
      run: npm ci
      
    - name: è¿è¡Œå•å…ƒæµ‹è¯•
      run: npm run test:unit
      
    - name: ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
      run: npm run test:coverage
      
    - name: è¿è¡ŒAPIæµ‹è¯•
      run: npm run test:api
      
    - name: ä¸Šä¼ è¦†ç›–ç‡åˆ° Codecov
      uses: codecov/codecov-action@v3
      with:
        file: ./coverage/coverage-final.json
```

## ğŸƒâ€â™‚ï¸ æµ‹è¯•æ‰§è¡Œæµç¨‹

### æœ¬åœ°å¼€å‘æµ‹è¯•
```bash
# 1. å®‰è£…æµ‹è¯•ä¾èµ–
npm install --save-dev jest @vue/test-utils @vue/cli-plugin-unit-jest cypress

# 2. è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:all

# 3. è¿è¡Œç‰¹å®šæµ‹è¯•
npm run test:unit -- PatientList.spec.js

# 4. ä½¿ç”¨ç›‘å¬æ¨¡å¼
npm run test:watch

# 5. è¿è¡ŒE2Eæµ‹è¯•
npm run test:e2e
```

### æµ‹è¯•ä¼˜å…ˆçº§
1. **P0 - å…³é”®åŠŸèƒ½**: ç™»å½•/æ³¨å†Œã€æ‚£è€…ä¿¡æ¯ç®¡ç†ã€é¢„çº¦ç³»ç»Ÿ
2. **P1 - é‡è¦åŠŸèƒ½**: åŒ»å˜±ç®¡ç†ã€è¯å“ç®¡ç†ã€æ”¶è´¹ç³»ç»Ÿ
3. **P2 - è¾…åŠ©åŠŸèƒ½**: æŠ¥è¡¨å¯¼å‡ºã€ç³»ç»Ÿè®¾ç½®ã€æ¶ˆæ¯é€šçŸ¥

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

### æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹
```markdown
# æµ‹è¯•æŠ¥å‘Š - ç‰ˆæœ¬ v1.2.0

## æµ‹è¯•æ¦‚è§ˆ
- æµ‹è¯•æ—¶é—´: 2024-01-15
- æµ‹è¯•ç¯å¢ƒ: å¼€å‘ç¯å¢ƒ
- æµ‹è¯•äººå‘˜: å‰ç«¯å›¢é˜Ÿ

## æµ‹è¯•ç»“æœ
| æµ‹è¯•ç±»å‹ | ç”¨ä¾‹æ€»æ•° | é€šè¿‡æ•° | å¤±è´¥æ•° | é€šè¿‡ç‡ |
|---------|---------|-------|-------|--------|
| å•å…ƒæµ‹è¯• | 156 | 150 | 6 | 96.2% |
| ç»„ä»¶æµ‹è¯• | 89 | 87 | 2 | 97.8% |
| E2Eæµ‹è¯• | 45 | 43 | 2 | 95.6% |
| APIæµ‹è¯• | 78 | 78 | 0 | 100% |

## è¦†ç›–ç‡æŠ¥å‘Š
- è¯­å¥è¦†ç›–ç‡: 82%
- åˆ†æ”¯è¦†ç›–ç‡: 78%
- å‡½æ•°è¦†ç›–ç‡: 88%
- è¡Œè¦†ç›–ç‡: 81%

## å…³é”®é—®é¢˜
1. **é«˜ä¼˜å…ˆçº§**: æ‚£è€…æœç´¢åŠŸèƒ½åœ¨ç‰¹å®šæ¡ä»¶ä¸‹å¤±æ•ˆ
2. **ä¸­ä¼˜å…ˆçº§**: ç§»åŠ¨ç«¯å“åº”å¼å¸ƒå±€é—®é¢˜
3. **ä½ä¼˜å…ˆçº§**: æ§åˆ¶å°è­¦å‘Šä¿¡æ¯

## å»ºè®®
1. å¢åŠ è¾¹ç¼˜æƒ…å†µæµ‹è¯•ç”¨ä¾‹
2. ä¼˜åŒ–ç§»åŠ¨ç«¯æµ‹è¯•è¦†ç›–ç‡
3. æ·»åŠ æ€§èƒ½æµ‹è¯•
```

## ğŸ› ï¸ æµ‹è¯•å·¥å…·æ¨è

### å¿…å¤‡å·¥å…·
1. **Jest** - å•å…ƒæµ‹è¯•æ¡†æ¶
2. **Vue Test Utils** - Vueç»„ä»¶æµ‹è¯•å·¥å…·
3. **Cypress** - E2Eæµ‹è¯•æ¡†æ¶
4. **Axios Mock Adapter** - APIè¯·æ±‚æ¨¡æ‹Ÿ

### è¾…åŠ©å·¥å…·
1. **Faker.js** - ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
2. **MSW (Mock Service Worker)** - API mocking
3. **Testing Library** - æ›´å¥½çš„æµ‹è¯•å®è·µ
4. **Lighthouse CI** - æ€§èƒ½æµ‹è¯•

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2024-01-15  
**ç»´æŠ¤å›¢é˜Ÿ**: å‰ç«¯å¼€å‘éƒ¨
